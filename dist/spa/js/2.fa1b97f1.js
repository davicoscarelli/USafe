(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(e,t){},1:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},8:function(e,t){},8041:function(e,t,s){"use strict";s("d924")},"8b24":function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{},[s("q-scroll-area",{ref:"chatArea",staticClass:"chat-area"},[e._l(e.messages,(function(t){return s("q-chat-message",{key:t.id,staticClass:"q-px-md q-pt-sm",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author},attrs:{text:[t.body],sent:"bot"!=t.author,"bg-color":"bot"==t.author?"secondary":"#e0e0e0","text-color":"bot"==t.author?"white":"black"}},[0==t.id?s("div",{staticClass:"col flex flex-center"},[s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Choking"},on:{click:function(t){return e.buttonSend("Choking")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Bleeding"},on:{click:function(t){return e.buttonSend("Bleeding")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Drowning"},on:{click:function(t){return e.buttonSend("Drowning")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Fractures"},on:{click:function(t){return e.buttonSend("Fractures")}}})],1):e._e()])})),e.loading?s("q-chat-message",{staticClass:"q-px-md q-pt-sm message-in",attrs:{"bg-color":"secondary","text-color":"white"}},[s("q-spinner-dots",{attrs:{size:"2rem"}})],1):e._e()],2),s("q-footer",{attrs:{elevated:""}},[s("q-toolbar",[s("q-form",{staticClass:"full-width ",on:{submit:function(t){return e.sendMessage("out")}}},[s("div",{staticClass:"row"},[s("q-input",{ref:"newMessage",staticClass:" col-11 q-pr-sm",attrs:{"bg-color":"white",rounded:"",placeholder:"Message",dense:"",outlined:""},model:{value:e.youMessage,callback:function(t){e.youMessage=t},expression:"youMessage"}},[[s("q-btn",{attrs:{round:"",dense:"",flat:"",type:"submit",icon:"send",color:"primary"}})]],2),s("div",{staticClass:"col-1 flex flex-center"},[e.recording?e._e():s("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"mic",color:"white"},on:{click:e.speechToText}}),e.recording?s("q-spinner-bars",{attrs:{color:"white",size:"2em"}}):e._e()],1)],1)])],1)],1)],1)},i=[],n=(s("e6cf"),s("c9d0")),r=s.n(n),a=s("2b0e");const c=s("b2ba");a["a"].use(r.a);var h={name:"PageIndex",data:()=>({botMessage:"",loading:!1,youMessage:"",recording:!1,history:[],messages:[]}),computed:{user(){return{name:"Davi",age:7}}},mounted(){this.botMessage="Welcome to WeSafe! Whats your emergency?",this.synthesizeSpeech(this.botMessage)},methods:{speechToText(){try{const e=c.SpeechConfig.fromSubscription("80336464dd984e3489ab38cbb895823e","eastus");let t=c.AudioConfig.fromDefaultMicrophoneInput(),s=new c.SpeechRecognizer(e,t);const o=c.PhraseListGrammar.fromRecognizer(s);o.addPhrase(["choking","no","yes","clear","me","other","someone","else"]),console.log("Speak into your microphone."),this.recording=!0,s.recognizeOnceAsync((e=>{this.youMessage=e.text,console.log(`RECOGNIZED: Text=${e.text}`),this.recording=!1,this.sendMessage("out")}))}catch(e){console.log("recognition",e)}},async synthesizeSpeech(e){new AudioContext;this.loading=!0;const t=c.SpeechConfig.fromSubscription("80336464dd984e3489ab38cbb895823e","eastus");t.speechSynthesisOutputFormat=c.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm;const s=new c.SpeechSynthesizer(t,void 0);s.speakTextAsync(e,(t=>{const o=t.audioData;this.loading=!1,console.log(e),console.log(`Audio data byte size: ${o.byteLength}.`),s.close(),this.sendMessage("in")}),(e=>{console.log(e),s.close()}))},postMessage(){},buttonSend(e){this.youMessage=e,this.sendMessage("out")},async bot(){let e=this.botMessage;const t=JSON.stringify(this.history);console.log(t,"inputtt"),0==this.history[0]?"[0]"==t?e="Is the victim you or someone else?":"[0,0]"==t?e="Is the victim having difficulty breathing?":"[0,0,0]"==t?e="Is the victim over 8 years old?":"[0,0,1]"==t?e="Is the victim conscious?":"[0,0,1,0]"==t||"[0,0,1,1]"==t?e="Is the victim over 8 years old?":"[0,0,0,1]"==t?e="ANSWER1":"[0,0,0,0]"==t?e="ANSWER2":"[0,0,1,0,0]"==t?e="ANSWER6":"[0,0,1,0,1]"==t?e="ANSWER5":"[0,0,1,1,0]"==t?e="ANSWER2":"[0,0,1,1,1]"==t?e="Is the victim Pregnant or Obese?":"[0,0,1,1,1,0]"==t?e="ANSWER3":"[0,0,1,1,1,1]"==t?e="ANSWER4":"[0,1]"===t?e="Are you having trouble breathing?":"[0,1,0]"==t?0==this.user.age.length?e="Are you over 8 years old?":this.user.age>8?(this.history.push(1),e="ANSWER1"):(this.history.push(0),e="ANSWER2+"):"[0,1,1]"==t?0==this.user.age.length?e="Are you over 8 years old?":this.user.age>8?(this.history.push(1),e="ANSWER3.2"):(this.history.push(0),e="Are you alone?"):"[0,1,0,0]"===t?e="ANSWER2+":"[0,1,0,1]"===t?e="ANSWER1":"[0,1,1,1]"===t?e="ANSWER3.2":"[0,1,1,0,0]"===t?e="ANSWER2+":"[0,1,1,0,1]"===t&&(e="CALL 911"):1==t[0]&&(e="other.1"),this.botMessage=e,await this.synthesizeSpeech(e)},async createHistory(e){let t=e.toLowerCase();console.log("Hmessage",t),"no"!==t&&!this.findWord("no",t)||0==this.history.length?"yes"!==t&&!this.findWord("yes",t)||0==this.history.length?"choking"!==t&&!this.findWord("choking",t)||0!=this.history.length?"clear"===t||this.findWord("clear",t)?this.clearAllMessages():"me"!==t&&!this.findWord("me",t)||0==this.history.length?("other"===t||this.findWord("other",t)||t.includes("someone else"))&&0!=this.history.length?this.history.push(0):this.botMessage="Sorry, I didn't understand. Can you repeat?":this.history.push(1):this.history.push(0):this.history.push(1):this.history.push(0)},findWord(e,t){let s=t.match(/[\w-']+|[^\w\s]+/g).some((function(t){return t===e}));return s},sendMessage(e){if(!this.youMessage&&!this.botMessage)return;"out"===e?(this.messages.push({body:this.youMessage,author:"you",id:this.messages.length}),this.createHistory(this.youMessage),this.youMessage="",this.bot()):"in"===e&&(console.log(this.botMessage,"bot"),this.messages.push({body:this.botMessage,author:"bot",id:this.messages.length}),this.botMessage="");let t=this.$refs.chatArea;t.setScrollPosition(t.$el.scrollHeight+1e3,1)},clearAllMessages(){this.messages=[{id:0,body:"Welcome to WeSafe! Whats your emergency?",author:"bot"}],this.history=[],this.synthesizeSpeech(this.messages[0].body)}}},l=h,u=(s("8041"),s("2877")),d=Object(u["a"])(l,o,i,!1,null,null,null);t["default"]=d.exports},9:function(e,t){},d924:function(e,t,s){}}]);