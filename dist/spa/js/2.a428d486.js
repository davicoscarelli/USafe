(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{0:function(t,e){},1:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},7:function(t,e){},8:function(t,e){},8041:function(t,e,s){"use strict";s("d924")},"8b24":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{},[s("q-scroll-area",{ref:"chatArea",staticClass:"chat-area"},[t._l(t.messages,(function(e){return s("q-chat-message",{key:e.id,staticClass:"q-px-md q-pt-sm",class:{"message-out":"you"===e.author,"message-in":"you"!==e.author},attrs:{text:[e.body],sent:"bot"!=e.author,"bg-color":"bot"==e.author?"secondary":"#e0e0e0","text-color":"bot"==e.author?"white":"black"}},[0==e.id?s("div",{staticClass:"col flex flex-center"},[s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Choking"},on:{click:function(e){return t.buttonSend("Choking")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Bleeding"},on:{click:function(e){return t.buttonSend("Bleeding")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Drowning"},on:{click:function(e){return t.buttonSend("Drowning")}}}),s("q-btn",{staticClass:"q-ma-xs",staticStyle:{width:"80%"},attrs:{rounded:"",color:"white","no-caps":"","text-color":"primary",label:"Fractures"},on:{click:function(e){return t.buttonSend("Fractures")}}})],1):t._e()])})),t.loading?s("q-chat-message",{staticClass:"q-px-md q-pt-sm message-in",attrs:{"bg-color":"secondary","text-color":"white"}},[s("q-spinner-dots",{attrs:{size:"2rem"}})],1):t._e()],2),s("q-footer",{attrs:{elevated:""}},[s("transition",{attrs:{name:"slide-fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showOptions,expression:"showOptions"}],staticClass:"row bg-secondary q-pa-sm justify-center ",staticStyle:{height:"50px"}},t._l(t.options[t.optionsType],(function(e){return s("q-btn",{key:e,staticClass:"q-mx-sm",staticStyle:{width:"30%"},attrs:{outline:"",rounded:"",color:"white","no-caps":"",dense:"","text-color":"white",label:e},on:{click:function(s){return t.optionSend(e)}}})})),1)]),s("q-toolbar",[s("q-form",{staticClass:"full-width ",on:{submit:function(e){return t.sendMessage("out")}}},[s("div",{staticClass:"row"},[s("q-input",{ref:"newMessage",staticClass:" col-11 q-pr-sm",attrs:{"bg-color":"white",rounded:"",placeholder:"Message",dense:"",outlined:""},model:{value:t.youMessage,callback:function(e){t.youMessage=e},expression:"youMessage"}},[[s("q-btn",{attrs:{round:"",dense:"",flat:"",type:"submit",icon:"send",color:"primary"}})]],2),s("div",{staticClass:"col-1 flex flex-center"},[t.recording?t._e():s("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"mic",color:"white"},on:{click:t.speechToText}}),t.recording?s("q-spinner-bars",{attrs:{color:"white",size:"2em"}}):t._e()],1)],1)])],1)],1)],1)},i=[],n=(s("e6cf"),s("c9d0")),a=s.n(n),r=s("2b0e");const h=s("b2ba");r["a"].use(a.a);var l={name:"PageIndex",data:()=>({botMessage:"",loading:!1,youMessage:"",audioContext:null,recording:!1,history:[],messages:[],options:[["Yes","No"],["Me","Someone else"]],showOptions:!1,optionsType:null}),computed:{user(){return{name:"Davi",age:7}}},created(){},mounted(){this.botMessage="Welcome to WeSafe! Whats your emergency?",this.audioContext=new AudioContext,this.synthesizeSpeech(this.botMessage)},methods:{speechToText(){try{const t=h.SpeechConfig.fromSubscription("80336464dd984e3489ab38cbb895823e","eastus");let e=h.AudioConfig.fromDefaultMicrophoneInput(),s=new h.SpeechRecognizer(t,e);const o=h.PhraseListGrammar.fromRecognizer(s);o.addPhrase(["choking","no","yes","clear","me","other","someone","else"]),console.log("Speak into your microphone."),this.recording=!0,s.recognizeOnceAsync((t=>{this.youMessage=t.text,console.log(`RECOGNIZED: Text=${t.text}`),this.recording=!1,this.sendMessage("out"),this.showOptions=!1}))}catch(t){console.log("recognition",t)}},async synthesizeSpeech(t){this.loading=!0;const e=h.SpeechConfig.fromSubscription("80336464dd984e3489ab38cbb895823e","eastus");e.speechSynthesisOutputFormat=h.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm;const s=new h.SpeechSynthesizer(e,void 0);s.speakTextAsync(t,(e=>{const o=e.audioData;this.loading=!1,console.log(t),console.log(`Audio data byte size: ${o.byteLength}.`),s.close(),null!=this.optionsType&&(this.showOptions=!0),this.sendMessage("in")}),(t=>{console.log(t),s.close()}))},postMessage(){},optionSend(t){this.youMessage=t,this.sendMessage("out"),this.showOptions=!1},buttonSend(t){this.youMessage=t,this.sendMessage("out")},async bot(){let t={text:this.botMessage,optionsType:this.optionsType};const e=JSON.stringify(this.history);console.log(e,"inputtt"),0==this.history[0]?"[0]"==e?t={text:"Is the victim you or someone else?",optionsType:1}:"[0,0]"==e?t={text:"Is the victim having difficulty breathing?",optionsType:0}:"[0,0,0]"==e?t={text:"Is the victim over 8 years old?",optionsType:0}:"[0,0,1]"==e?t={text:"Is the victim conscious?",optionsType:0}:"[0,0,1,0]"==e||"[0,0,1,1]"==e?t={text:"Is the victim over 8 years old?",optionsType:0}:"[0,0,0,1]"==e?t={text:"ANSWER1",optionsType:null}:"[0,0,0,0]"==e?t={text:"ANSWER2",optionsType:null}:"[0,0,1,0,0]"==e?t={text:"ANSWER6",optionsType:null}:"[0,0,1,0,1]"==e?t={text:"ANSWER5",optionsType:null}:"[0,0,1,1,0]"==e?t={text:"ANSWER2",optionsType:null}:"[0,0,1,1,1]"==e?t={text:"Is the victim Pregnant or Obese?",optionsType:0}:"[0,0,1,1,1,0]"==e?t={text:"ANSWER3",optionsType:null}:"[0,0,1,1,1,1]"==e?t={text:"ANSWER4",optionsType:null}:"[0,1]"===e?t={text:"Are you having trouble breathing?",optionsType:0}:"[0,1,0]"==e?0==this.user.age.length?t={text:"Are you over 8 years old?",optionsType:0}:this.user.age>8?(this.history.push(1),t={text:"ANSWER1",optionsType:null}):(this.history.push(0),t={text:"ANSWER2+",optionsType:null}):"[0,1,1]"==e?0==this.user.age.length?t={text:"Are you over 8 years old?",optionsType:0}:this.user.age>8?(this.history.push(1),t={text:"ANSWER3.2",optionsType:null}):(this.history.push(0),t={text:"Are you alone?",optionsType:0}):"[0,1,0,0]"===e?t={text:"ANSWER2+",optionsType:null}:"[0,1,0,1]"===e?t={text:"ANSWER1",optionsType:null}:"[0,1,1,1]"===e?t={text:"ANSWER3.2",optionsType:null}:"[0,1,1,0,0]"===e?t={text:"ANSWER2+",optionsType:null}:"[0,1,1,0,1]"===e&&(t={text:"CALL 911",optionsType:null}):1==e[0]&&(t={text:"other.1",optionsType:0}),this.botMessage=t.text,this.optionsType=t.optionsType,await this.synthesizeSpeech(t.text)},async createHistory(t){let e=t.toLowerCase();console.log("Hmessage",e),"no"!==e&&!this.findWord("no",e)||0==this.history.length?("yep"===e||"yes"===e||"yeah"===e||this.findWord("yes",e)||this.findWord("yep",e)||this.findWord("yeah",e))&&0!=this.history.length?this.history.push(1):"choking"!==e&&!this.findWord("choking",e)||0!=this.history.length?"clear"===e||this.findWord("clear",e)?this.clearAllMessages():"me"!==e&&!this.findWord("me",e)||0==this.history.length?("other"===e||this.findWord("other",e)||e.includes("someone else"))&&0!=this.history.length?this.history.push(0):this.botMessage="Sorry, I didn't understand. Can you repeat?":this.history.push(1):this.history.push(0):this.history.push(0)},findWord(t,e){let s=e.match(/[\w-']+|[^\w\s]+/g).some((function(e){return e===t}));return s},sendMessage(t){if(!this.youMessage&&!this.botMessage)return;"out"===t?(this.messages.push({body:this.youMessage,author:"you",id:this.messages.length}),this.createHistory(this.youMessage),this.youMessage="",this.bot()):"in"===t&&(console.log(this.botMessage,"bot"),this.messages.push({body:this.botMessage,author:"bot",id:this.messages.length}),this.botMessage="");let e=this.$refs.chatArea;e.setScrollPosition(e.$el.scrollHeight+1e3,1)},clearAllMessages(){this.messages=[{id:0,body:"Welcome to WeSafe! Whats your emergency?",author:"bot"}],this.history=[],this.synthesizeSpeech(this.messages[0].body)}}},c=l,u=(s("8041"),s("2877")),p=Object(u["a"])(c,o,i,!1,null,null,null);e["default"]=p.exports},9:function(t,e){},d924:function(t,e,s){}}]);